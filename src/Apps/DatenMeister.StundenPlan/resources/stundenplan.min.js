var _Types,_Forms;!function(e){class t{}t._name_="name",t.timeStart="timeStart",t.hoursDuration="hoursDuration",t.weekInterval="weekInterval",t.weekOffset="weekOffset",t.onMonday="onMonday",t.onTuesday="onTuesday",t.onWednesday="onWednesday",t.onThursday="onThursday",t.onFriday="onFriday",t.onSaturday="onSaturday",t.onSunday="onSunday",e._WeeklyPeriodicEvent=t,e.__WeeklyPeriodicEvent_Uri="dm:///types.stundenplan.datenmeister/#954ad359-1a92-4661-bc58-83ea4517d493"}(_Types=_Types||{}),function(e){class t{}t._name_="name",t.title="title",t.isReadOnly="isReadOnly",t.isAutoGenerated="isAutoGenerated",t.hideMetaInformation="hideMetaInformation",t.originalUri="originalUri",t.creationProtocol="creationProtocol",e._SchedulerForm=t,e.__SchedulerForm_Uri="dm:///types.stundenplan.datenmeister/#9b107f7e-59c0-4164-b761-78764223afa2"}(_Forms=_Forms||{});import*as Mof from"/js/datenmeister/Mof.js";import*as FormFactory from"/js/datenmeister/forms/FormFactory.js";import*as StundenPlanTypes from"./DatenMeister.StundenPlan.js";import*as ClientItems from"/js/datenmeister/client/Items.js";import{_DatenMeister}from"/js/datenmeister/models/DatenMeister.class.js";function init(){FormFactory.registerObjectForm(StundenPlanTypes._Forms.__SchedulerForm_Uri,()=>new StundenPlanForm),"function"==typeof describe&&describe("StundenPlanMeister Tests",function(){it("Create Empty Table",function(){var e=$("#test_area");new WeeklyCalenderControl(e).createTable({weeks:4})}),it("Test Event Manager",function(){var e=new Mof.DmObject,t=(e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onTuesday,!0),e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"09:00"),e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,1),e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,0),e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event1"),new Mof.DmObject),n=(t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onWednesday,!0),t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"09:00"),t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,2),t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,0),t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event2"),new Mof.DmObject),s=(n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onWednesday,!0),n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"09:00"),n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,2),n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,1),n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event3"),new Mof.DmObject),a=(s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onThursday,!0),s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"09:00"),s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,1),s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,0),s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event4"),new Mof.DmObject),e=(a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onThursday,!0),a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"08:00"),a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,1),a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,0),a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event5"),new PeriodicEventManager([e,t,n,s,a])),t=e.getEventsOnWeekday(0,2),n=(chai.assert(1===t.length,"Tuesday first length"),chai.assert("Event1"===t[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event1 not on first Tuesday"),e.getEventsOnWeekday(1,2)),s=(chai.assert(1===n.length,"Tuesday second week"),chai.assert("Event1"===n[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event1 not on second tuesday"),e.getEventsOnWeekday(0,3)),a=(chai.assert(1===s.length,"Wednesday first week length"),chai.assert("Event2"===s[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event2 not on first Wednesday"),e.getEventsOnWeekday(1,3)),t=(chai.assert(1===a.length,"Wednesday second week length"),chai.assert("Event3"===a[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event3 not on second Wednesday"),e.getEventsOnWeekday(0,4));chai.assert(2===t.length,"Thursday first week"),chai.assert("Event5"===t[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event5 as first Thursday event"),chai.assert("Event4"===t[1].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event4 as second Thursday event")})})}class StundenPlanForm{async createFormByObject(e,t){var n=$("<span>Scheduler</span>");e.append(n);var s=(await ClientItems.getObjectByUri(this.workspace,this.itemUrl)).get(_DatenMeister._CommonTypes._Default._Package.packagedElement,Mof.ObjectType.Array),a=(null==s&&e.append($("<span>The element did not include the packagedElements")),new WeeklyCalenderControl(n));for(const i in s){var r=s[i];r.metaClass.uri===StundenPlanTypes._Types.__WeeklyPeriodicEvent_Uri&&a.addPeriodicEvent(r)}a.createTable({weeks:4})}refreshForm(){}async storeFormValuesIntoDom(e){return new Mof.DmObject}}class WeeklyCalenderControl{constructor(e){this.cells=new Array,this.container=e,this.isTableCreated=!1,this.events=new Array}createTable(e){void 0===e.weeks&&(e.weeks=4),void 0===e.showWeeks&&(e.showWeeks=!0),void 0===e.skipWeekend&&(e.skipWeekend=!1),this.isTableCreated&&void 0!==this.table&&(this.table.remove(),this.cells.length=0);var n=new PeriodicEventManager(this.events),s=$("<table class='stundenplan'></table>");for(let t=0;t<e.weeks;t++){var a,r=$("<tr></tr>"),i=(e.showWeeks&&((a=$("<td></td>")).text("Week "+(t+1).toString()),r.append(a)),e.skipWeekend?5:7);for(let e=1;e<=i;e++){var o=$("<td></td>"),d=$("<div class='stundenplan-weekday'></div>"),y=(d.text(getWeekDay(e)),o.append(d),n.getEventsOnWeekday(t,e));for(const p in y){var l=y[p],c=$("<div class='stundenplan-event'></div>"),_=l.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,Mof.ObjectType.String),l=l.get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String);c.text(_+" "+l),o.append(c)}this.cells.push(o),r.append(o)}s.append(r)}this.container.append(s),this.table=s}addPeriodicEvent(e){this.events.push(e)}}class PeriodicEventManager{constructor(e){this.events=e}getEventsOnWeekday(t,e){var n=new Array;for(const r in this.events){var s=this.events[r];if(isPeriodicEventApplicableOnWeekday(s,e)){var a=s.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,Mof.ObjectType.Number)??0;let e=s.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,Mof.ObjectType.Number);(t-a)%(e=void 0===e||e<1?1:e)==0&&n.push(s)}}return n.sort((e,t)=>{e=e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,Mof.ObjectType.String),t=t.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,Mof.ObjectType.String);return e===t?0:e<t?-1:1}),n}}function isPeriodicEventApplicableOnWeekday(e,t){switch(t){case 1:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onMonday,Mof.ObjectType.Boolean);case 2:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onTuesday,Mof.ObjectType.Boolean);case 3:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onWednesday,Mof.ObjectType.Boolean);case 4:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onThursday,Mof.ObjectType.Boolean);case 5:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onFriday,Mof.ObjectType.Boolean);case 6:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onSaturday,Mof.ObjectType.Boolean);case 7:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onSunday,Mof.ObjectType.Boolean)}}function getWeekDay(e){if(e<1||7<e)throw"Invalid argument, must be between 1 and 7";switch(e){case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";case 7:return"Sunday"}}!function(e){class t{}t._name_="name",t.timeStart="timeStart",t.hoursDuration="hoursDuration",t.weekInterval="weekInterval",t.weekOffset="weekOffset",t.onMonday="onMonday",t.onTuesday="onTuesday",t.onWednesday="onWednesday",t.onThursday="onThursday",t.onFriday="onFriday",t.onSaturday="onSaturday",t.onSunday="onSunday",e._WeeklyPeriodicEvent=t,e.__WeeklyPeriodicEvent_Uri="dm:///types.stundenplan.datenmeister/#954ad359-1a92-4661-bc58-83ea4517d493"}(_Types=_Types||{}),function(e){class t{}t._name_="name",t.title="title",t.isReadOnly="isReadOnly",t.isAutoGenerated="isAutoGenerated",t.hideMetaInformation="hideMetaInformation",t.originalUri="originalUri",t.creationProtocol="creationProtocol",e._SchedulerForm=t,e.__SchedulerForm_Uri="dm:///types.stundenplan.datenmeister/#9b107f7e-59c0-4164-b761-78764223afa2"}(_Forms=_Forms||{});import*as Mof from"/js/datenmeister/Mof.js";import*as FormFactory from"/js/datenmeister/forms/FormFactory.js";import*as StundenPlanTypes from"./DatenMeister.StundenPlan.js";import*as ClientItems from"/js/datenmeister/client/Items.js";import{_DatenMeister}from"/js/datenmeister/models/DatenMeister.class.js";function init(){FormFactory.registerObjectForm(StundenPlanTypes._Forms.__SchedulerForm_Uri,()=>new StundenPlanForm),"function"==typeof describe&&describe("StundenPlanMeister Tests",function(){it("Create Empty Table",function(){var e=$("#test_area");new WeeklyCalenderControl(e).createTable({weeks:4})}),it("Test Event Manager",function(){var e=new Mof.DmObject;e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onTuesday,!0),e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"09:00"),e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,1),e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,0),e.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event1"),(t=new Mof.DmObject).set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onWednesday,!0),t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"09:00"),t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,2),t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,0),t.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event2"),(n=new Mof.DmObject).set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onWednesday,!0),n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"09:00"),n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,2),n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,1),n.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event3"),(s=new Mof.DmObject).set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onThursday,!0),s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"09:00"),s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,1),s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,0),s.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event4"),(a=new Mof.DmObject).set(StundenPlanTypes._Types._WeeklyPeriodicEvent.onThursday,!0),a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,"08:00"),a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,1),a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,0),a.set(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,"Event5");var t=(e=new PeriodicEventManager([e,t,n,s,a])).getEventsOnWeekday(0,2),n=(chai.assert(1===t.length,"Tuesday first length"),chai.assert("Event1"===t[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event1 not on first Tuesday"),e.getEventsOnWeekday(1,2)),s=(chai.assert(1===n.length,"Tuesday second week"),chai.assert("Event1"===n[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event1 not on second tuesday"),e.getEventsOnWeekday(0,3)),a=(chai.assert(1===s.length,"Wednesday first week length"),chai.assert("Event2"===s[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event2 not on first Wednesday"),e.getEventsOnWeekday(1,3)),t=(chai.assert(1===a.length,"Wednesday second week length"),chai.assert("Event3"===a[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event3 not on second Wednesday"),e.getEventsOnWeekday(0,4));chai.assert(2===t.length,"Thursday first week"),chai.assert("Event5"===t[0].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event5 as first Thursday event"),chai.assert("Event4"===t[1].get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String),"Event4 as second Thursday event")})})}class StundenPlanForm{async createFormByObject(e,t){var n=$("<span>Scheduler</span>"),s=(e.append(n),(await ClientItems.getObjectByUri(this.workspace,this.itemUrl)).get(_DatenMeister._CommonTypes._Default._Package.packagedElement,Mof.ObjectType.Array)),a=(null==s&&e.append($("<span>The element did not include the packagedElements")),new WeeklyCalenderControl(n));for(const i in s){var r=s[i];r.metaClass.uri===StundenPlanTypes._Types.__WeeklyPeriodicEvent_Uri&&a.addPeriodicEvent(r)}a.createTable({weeks:4})}refreshForm(){}async storeFormValuesIntoDom(e){return new Mof.DmObject}}class WeeklyCalenderControl{constructor(e){this.cells=new Array,this.container=e,this.isTableCreated=!1,this.events=new Array}createTable(e){void 0===e.weeks&&(e.weeks=4),this.isTableCreated&&void 0!==this.table&&(this.table.remove(),this.cells.length=0);var n=new PeriodicEventManager(this.events),s=$("<table class='stundenplan'></table>");for(let t=0;t<e.weeks;t++){var a=$("<tr></tr>");for(let e=1;e<=7;e++){var r=$("<td></td>"),i=$("<div class='stundenplan-weekday'></div>"),o=(i.text(getWeekDay(e)),r.append(i),n.getEventsOnWeekday(t,e));for(const c in o){var d=o[c],y=$("<div class='stundenplan-event'></div>"),l=d.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,Mof.ObjectType.String),d=d.get(StundenPlanTypes._Types._WeeklyPeriodicEvent._name_,Mof.ObjectType.String);y.text(l+" "+d),r.append(y)}this.cells.push(r),a.append(r)}s.append(a)}this.container.append(s),this.table=s}addPeriodicEvent(e){this.events.push(e)}}class PeriodicEventManager{constructor(e){this.events=e}getEventsOnWeekday(e,t){var n=new Array;for(const r in this.events){var s,a=this.events[r];isPeriodicEventApplicableOnWeekday(a,t)&&(e-(a.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekOffset,Mof.ObjectType.Number)??0))%(s=void 0===(s=a.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.weekInterval,Mof.ObjectType.Number))||s<1?1:s)==0&&n.push(a)}return n.sort((e,t)=>(e=e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,Mof.ObjectType.String))===(t=t.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.timeStart,Mof.ObjectType.String))?0:e<t?-1:1),n}}function isPeriodicEventApplicableOnWeekday(e,t){switch(t){case 1:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onMonday,Mof.ObjectType.Boolean);case 2:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onTuesday,Mof.ObjectType.Boolean);case 3:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onWednesday,Mof.ObjectType.Boolean);case 4:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onThursday,Mof.ObjectType.Boolean);case 5:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onFriday,Mof.ObjectType.Boolean);case 6:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onSaturday,Mof.ObjectType.Boolean);case 7:return e.get(StundenPlanTypes._Types._WeeklyPeriodicEvent.onSunday,Mof.ObjectType.Boolean)}}function getWeekDay(e){if(e<1||7<e)throw"Invalid argument, must be between 1 and 7";switch(e){case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";case 7:return"Sunday"}}define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._Forms=t._Types=void 0;{var n=t._Types||(t._Types={});class s{}s._name_="name",s.timeStart="timeStart",s.hoursDuration="hoursDuration",s.weekInterval="weekInterval",s.weekOffset="weekOffset",s.onMonday="onMonday",s.onTuesday="onTuesday",s.onWednesday="onWednesday",s.onThursday="onThursday",s.onFriday="onFriday",s.onSaturday="onSaturday",s.onSunday="onSunday",n._WeeklyPeriodicEvent=s,n.__WeeklyPeriodicEvent_Uri="dm:///types.stundenplan.datenmeister/#954ad359-1a92-4661-bc58-83ea4517d493"}{n=t._Forms||(t._Forms={});class a{}a._name_="name",a.title="title",a.isReadOnly="isReadOnly",a.isAutoGenerated="isAutoGenerated",a.hideMetaInformation="hideMetaInformation",a.originalUri="originalUri",a.creationProtocol="creationProtocol",n._SchedulerForm=a,n.__SchedulerForm_Uri="dm:///types.stundenplan.datenmeister/#9b107f7e-59c0-4164-b761-78764223afa2"}});var __awaiter=this&&this.__awaiter||function(e,i,o,d){return new(o=o||Promise)(function(n,t){function s(e){try{r(d.next(e))}catch(e){t(e)}}function a(e){try{r(d.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof o?t:new o(function(e){e(t)})).then(s,a)}r((d=d.apply(e,i||[])).next())})};define(["require","exports","datenmeister/../Mof","datenmeister/../Mof","datenmeister/../forms/FormFactory","module/DatenMeister.StundenPlan","datenmeister/../client/Items","datenmeister/../models/DatenMeister.class"],function(e,t,r,_,n,p,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WeeklyCalenderControl=t.init=void 0,t.init=function(){n.registerObjectForm(p._Forms.__SchedulerForm_Uri,()=>new s),"function"==typeof describe&&describe("StundenPlanMeister Tests",function(){it("Create Empty Table",function(){var e=$("#test_area");new d(e).createTable({weeks:4})}),it("Test Event Manager",function(){var e=new r.DmObject,t=(e.set(p._Types._WeeklyPeriodicEvent.onTuesday,!0),e.set(p._Types._WeeklyPeriodicEvent.timeStart,"09:00"),e.set(p._Types._WeeklyPeriodicEvent.weekInterval,1),e.set(p._Types._WeeklyPeriodicEvent.weekOffset,0),e.set(p._Types._WeeklyPeriodicEvent._name_,"Event1"),(t=new r.DmObject).set(p._Types._WeeklyPeriodicEvent.onWednesday,!0),t.set(p._Types._WeeklyPeriodicEvent.timeStart,"09:00"),t.set(p._Types._WeeklyPeriodicEvent.weekInterval,2),t.set(p._Types._WeeklyPeriodicEvent.weekOffset,0),t.set(p._Types._WeeklyPeriodicEvent._name_,"Event2"),(n=new r.DmObject).set(p._Types._WeeklyPeriodicEvent.onWednesday,!0),n.set(p._Types._WeeklyPeriodicEvent.timeStart,"09:00"),n.set(p._Types._WeeklyPeriodicEvent.weekInterval,2),n.set(p._Types._WeeklyPeriodicEvent.weekOffset,1),n.set(p._Types._WeeklyPeriodicEvent._name_,"Event3"),(s=new r.DmObject).set(p._Types._WeeklyPeriodicEvent.onThursday,!0),s.set(p._Types._WeeklyPeriodicEvent.timeStart,"09:00"),s.set(p._Types._WeeklyPeriodicEvent.weekInterval,1),s.set(p._Types._WeeklyPeriodicEvent.weekOffset,0),s.set(p._Types._WeeklyPeriodicEvent._name_,"Event4"),(a=new r.DmObject).set(p._Types._WeeklyPeriodicEvent.onThursday,!0),a.set(p._Types._WeeklyPeriodicEvent.timeStart,"08:00"),a.set(p._Types._WeeklyPeriodicEvent.weekInterval,1),a.set(p._Types._WeeklyPeriodicEvent.weekOffset,0),a.set(p._Types._WeeklyPeriodicEvent._name_,"Event5"),(e=new T([e,t,n,s,a])).getEventsOnWeekday(0,2)),n=(chai.assert(1===t.length,"Tuesday first length"),chai.assert("Event1"===t[0].get(p._Types._WeeklyPeriodicEvent._name_,_.ObjectType.String),"Event1 not on first Tuesday"),e.getEventsOnWeekday(1,2)),s=(chai.assert(1===n.length,"Tuesday second week"),chai.assert("Event1"===n[0].get(p._Types._WeeklyPeriodicEvent._name_,_.ObjectType.String),"Event1 not on second tuesday"),e.getEventsOnWeekday(0,3)),a=(chai.assert(1===s.length,"Wednesday first week length"),chai.assert("Event2"===s[0].get(p._Types._WeeklyPeriodicEvent._name_,_.ObjectType.String),"Event2 not on first Wednesday"),e.getEventsOnWeekday(1,3)),t=(chai.assert(1===a.length,"Wednesday second week length"),chai.assert("Event3"===a[0].get(p._Types._WeeklyPeriodicEvent._name_,_.ObjectType.String),"Event3 not on second Wednesday"),e.getEventsOnWeekday(0,4));chai.assert(2===t.length,"Thursday first week"),chai.assert("Event5"===t[0].get(p._Types._WeeklyPeriodicEvent._name_,_.ObjectType.String),"Event5 as first Thursday event"),chai.assert("Event4"===t[1].get(p._Types._WeeklyPeriodicEvent._name_,_.ObjectType.String),"Event4 as second Thursday event")})})};class s{createFormByObject(r,e){return __awaiter(this,void 0,void 0,function*(){var e=$("<span>Scheduler</span>"),t=(r.append(e),(yield i.getObjectByUri(this.workspace,this.itemUrl)).get(o._DatenMeister._CommonTypes._Default._Package.packagedElement,_.ObjectType.Array)),n=(null==t&&r.append($("<span>The element did not include the packagedElements")),new d(e));for(const a in t){var s=t[a];s.metaClass.uri===p._Types.__WeeklyPeriodicEvent_Uri&&n.addPeriodicEvent(s)}n.createTable({weeks:4})})}refreshForm(){}storeFormValuesIntoDom(e){return __awaiter(this,void 0,void 0,function*(){return new r.DmObject})}}class d{constructor(e){this.cells=new Array,this.container=e,this.isTableCreated=!1,this.events=new Array}createTable(e){void 0===e.weeks&&(e.weeks=4),this.isTableCreated&&void 0!==this.table&&(this.table.remove(),this.cells.length=0);var n=new T(this.events),s=$("<table class='stundenplan'></table>");for(let t=0;t<e.weeks;t++){var a=$("<tr></tr>");for(let e=1;e<=7;e++){var r=$("<td></td>"),i=$("<div class='stundenplan-weekday'></div>"),o=(i.text(function(e){if(e<1||7<e)throw"Invalid argument, must be between 1 and 7";switch(e){case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";case 7:return"Sunday"}}(e)),r.append(i),n.getEventsOnWeekday(t,e));for(const c in o){var d=o[c],y=$("<div class='stundenplan-event'></div>"),l=d.get(p._Types._WeeklyPeriodicEvent.timeStart,_.ObjectType.String),d=d.get(p._Types._WeeklyPeriodicEvent._name_,_.ObjectType.String);y.text(l+" "+d),r.append(y)}this.cells.push(r),a.append(r)}s.append(a)}this.container.append(s),this.table=s}addPeriodicEvent(e){this.events.push(e)}}t.WeeklyCalenderControl=d;class T{constructor(e){this.events=e}getEventsOnWeekday(e,t){var n=new Array;for(const r in this.events){var s,a=this.events[r];!function(e){switch(t){case 1:return e.get(p._Types._WeeklyPeriodicEvent.onMonday,_.ObjectType.Boolean);case 2:return e.get(p._Types._WeeklyPeriodicEvent.onTuesday,_.ObjectType.Boolean);case 3:return e.get(p._Types._WeeklyPeriodicEvent.onWednesday,_.ObjectType.Boolean);case 4:return e.get(p._Types._WeeklyPeriodicEvent.onThursday,_.ObjectType.Boolean);case 5:return e.get(p._Types._WeeklyPeriodicEvent.onFriday,_.ObjectType.Boolean);case 6:return e.get(p._Types._WeeklyPeriodicEvent.onSaturday,_.ObjectType.Boolean);case 7:return e.get(p._Types._WeeklyPeriodicEvent.onSunday,_.ObjectType.Boolean)}}(a)||(e-(null!=(s=a.get(p._Types._WeeklyPeriodicEvent.weekOffset,_.ObjectType.Number))?s:0))%(void 0===(s=a.get(p._Types._WeeklyPeriodicEvent.weekInterval,_.ObjectType.Number))||s<1?1:s)!=0||n.push(a)}return n.sort((e,t)=>(e=e.get(p._Types._WeeklyPeriodicEvent.timeStart,_.ObjectType.String))===(t=t.get(p._Types._WeeklyPeriodicEvent.timeStart,_.ObjectType.String))?0:e<t?-1:1),n}}});export{_Types,_Forms,init,WeeklyCalenderControl,_Types,_Forms,init,WeeklyCalenderControl};
//# sourceMappingURL=sourceMap.map