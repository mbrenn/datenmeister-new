define(["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._Forms=t._Types=void 0;{var n=t._Types||(t._Types={});class s{}s._name_="name",s.timeStart="timeStart",s.hoursDuration="hoursDuration",s.weekInterval="weekInterval",s.weekOffset="weekOffset",s.onMonday="onMonday",s.onTuesday="onTuesday",s.onWednesday="onWednesday",s.onThursday="onThursday",s.onFriday="onFriday",s.onSaturday="onSaturday",s.onSunday="onSunday",n._WeeklyPeriodicEvent=s,n.__WeeklyPeriodicEvent_Uri="dm:///types.stundenplan.datenmeister/#954ad359-1a92-4661-bc58-83ea4517d493"}{n=t._Forms||(t._Forms={});class r{}r._name_="name",r.title="title",r.isReadOnly="isReadOnly",r.isAutoGenerated="isAutoGenerated",r.hideMetaInformation="hideMetaInformation",r.originalUri="originalUri",r.creationProtocol="creationProtocol",n._SchedulerForm=r,n.__SchedulerForm_Uri="dm:///types.stundenplan.datenmeister/#9b107f7e-59c0-4164-b761-78764223afa2"}});var __awaiter=this&&this.__awaiter||function(e,i,o,d){return new(o=o||Promise)(function(n,t){function s(e){try{a(d.next(e))}catch(e){t(e)}}function r(e){try{a(d.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?n(e.value):((t=e.value)instanceof o?t:new o(function(e){e(t)})).then(s,r)}a((d=d.apply(e,i||[])).next())})};define(["require","exports","datenmeister/../Mof","datenmeister/../Mof","datenmeister/../forms/FormFactory","module/DatenMeister.StundenPlan","datenmeister/../client/Items","datenmeister/../models/DatenMeister.class"],function(e,t,a,l,n,v,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WeeklyCalenderControl=t.init=void 0,t.init=function(){n.registerObjectForm(v._Forms.__SchedulerForm_Uri,()=>new s),"function"==typeof describe&&describe("StundenPlanMeister Tests",function(){it("Create Empty Table",function(){var e=$("#test_area");new d(e).createTable({weeks:4})}),it("Test Event Manager",function(){var e=new a.DmObject,t=(e.set(v._Types._WeeklyPeriodicEvent.onTuesday,!0),e.set(v._Types._WeeklyPeriodicEvent.timeStart,"09:00"),e.set(v._Types._WeeklyPeriodicEvent.weekInterval,1),e.set(v._Types._WeeklyPeriodicEvent.weekOffset,0),e.set(v._Types._WeeklyPeriodicEvent._name_,"Event1"),new a.DmObject),n=(t.set(v._Types._WeeklyPeriodicEvent.onWednesday,!0),t.set(v._Types._WeeklyPeriodicEvent.timeStart,"09:00"),t.set(v._Types._WeeklyPeriodicEvent.weekInterval,2),t.set(v._Types._WeeklyPeriodicEvent.weekOffset,0),t.set(v._Types._WeeklyPeriodicEvent._name_,"Event2"),new a.DmObject),s=(n.set(v._Types._WeeklyPeriodicEvent.onWednesday,!0),n.set(v._Types._WeeklyPeriodicEvent.timeStart,"09:00"),n.set(v._Types._WeeklyPeriodicEvent.weekInterval,2),n.set(v._Types._WeeklyPeriodicEvent.weekOffset,1),n.set(v._Types._WeeklyPeriodicEvent._name_,"Event3"),new a.DmObject),r=(s.set(v._Types._WeeklyPeriodicEvent.onThursday,!0),s.set(v._Types._WeeklyPeriodicEvent.timeStart,"09:00"),s.set(v._Types._WeeklyPeriodicEvent.weekInterval,1),s.set(v._Types._WeeklyPeriodicEvent.weekOffset,0),s.set(v._Types._WeeklyPeriodicEvent._name_,"Event4"),new a.DmObject),e=(r.set(v._Types._WeeklyPeriodicEvent.onThursday,!0),r.set(v._Types._WeeklyPeriodicEvent.timeStart,"08:00"),r.set(v._Types._WeeklyPeriodicEvent.weekInterval,1),r.set(v._Types._WeeklyPeriodicEvent.weekOffset,0),r.set(v._Types._WeeklyPeriodicEvent._name_,"Event5"),new p([e,t,n,s,r])),t=e.getEventsOnWeekday(0,2),n=(chai.assert(1===t.length,"Tuesday first length"),chai.assert("Event1"===t[0].get(v._Types._WeeklyPeriodicEvent._name_,l.ObjectType.String),"Event1 not on first Tuesday"),e.getEventsOnWeekday(1,2)),s=(chai.assert(1===n.length,"Tuesday second week"),chai.assert("Event1"===n[0].get(v._Types._WeeklyPeriodicEvent._name_,l.ObjectType.String),"Event1 not on second tuesday"),e.getEventsOnWeekday(0,3)),r=(chai.assert(1===s.length,"Wednesday first week length"),chai.assert("Event2"===s[0].get(v._Types._WeeklyPeriodicEvent._name_,l.ObjectType.String),"Event2 not on first Wednesday"),e.getEventsOnWeekday(1,3)),t=(chai.assert(1===r.length,"Wednesday second week length"),chai.assert("Event3"===r[0].get(v._Types._WeeklyPeriodicEvent._name_,l.ObjectType.String),"Event3 not on second Wednesday"),e.getEventsOnWeekday(0,4));chai.assert(2===t.length,"Thursday first week"),chai.assert("Event5"===t[0].get(v._Types._WeeklyPeriodicEvent._name_,l.ObjectType.String),"Event5 as first Thursday event"),chai.assert("Event4"===t[1].get(v._Types._WeeklyPeriodicEvent._name_,l.ObjectType.String),"Event4 as second Thursday event")})})};class s{createFormByObject(a,e){return __awaiter(this,void 0,void 0,function*(){var e=$("<span>Scheduler</span>");a.append(e);var t=(yield i.getObjectByUri(this.workspace,this.itemUrl)).get(o._DatenMeister._CommonTypes._Default._Package.packagedElement,l.ObjectType.Array),n=(null==t&&a.append($("<span>The element did not include the packagedElements")),new d(e));for(const r in t){var s=t[r];s.metaClass.uri===v._Types.__WeeklyPeriodicEvent_Uri&&n.addPeriodicEvent(s)}n.createTable({weeks:4})})}refreshForm(){}storeFormValuesIntoDom(e){return __awaiter(this,void 0,void 0,function*(){return new a.DmObject})}}class d{constructor(e){this.cells=new Array,this.container=e,this.isTableCreated=!1,this.events=new Array}createTable(e){void 0===e.weeks&&(e.weeks=4),this.isTableCreated&&void 0!==this.table&&(this.table.remove(),this.cells.length=0);var n=new p(this.events),s=$("<table class='stundenplan'></table>");for(let t=0;t<e.weeks;t++){var r=$("<tr></tr>");for(let e=1;e<=7;e++){var a=$("<td></td>"),i=$("<div class='stundenplan-weekday'></div>"),o=(i.text(function(e){if(e<1||7<e)throw"Invalid argument, must be between 1 and 7";switch(e){case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";case 7:return"Sunday"}}(e)),a.append(i),n.getEventsOnWeekday(t,e));for(const _ in o){var d=o[_],y=$("<div class='stundenplan-event'></div>"),c=d.get(v._Types._WeeklyPeriodicEvent.timeStart,l.ObjectType.String),d=d.get(v._Types._WeeklyPeriodicEvent._name_,l.ObjectType.String);y.text(c+" "+d),a.append(y)}this.cells.push(a),r.append(a)}s.append(r)}this.container.append(s),this.table=s}addPeriodicEvent(e){this.events.push(e)}}t.WeeklyCalenderControl=d;class p{constructor(e){this.events=e}getEventsOnWeekday(t,e){var n=new Array;for(const a in this.events){var s=this.events[a];if(function(e,t){switch(t){case 1:return e.get(v._Types._WeeklyPeriodicEvent.onMonday,l.ObjectType.Boolean);case 2:return e.get(v._Types._WeeklyPeriodicEvent.onTuesday,l.ObjectType.Boolean);case 3:return e.get(v._Types._WeeklyPeriodicEvent.onWednesday,l.ObjectType.Boolean);case 4:return e.get(v._Types._WeeklyPeriodicEvent.onThursday,l.ObjectType.Boolean);case 5:return e.get(v._Types._WeeklyPeriodicEvent.onFriday,l.ObjectType.Boolean);case 6:return e.get(v._Types._WeeklyPeriodicEvent.onSaturday,l.ObjectType.Boolean);case 7:return e.get(v._Types._WeeklyPeriodicEvent.onSunday,l.ObjectType.Boolean)}}(s,e)){var r=null!=(r=s.get(v._Types._WeeklyPeriodicEvent.weekOffset,l.ObjectType.Number))?r:0;let e=s.get(v._Types._WeeklyPeriodicEvent.weekInterval,l.ObjectType.Number);(t-r)%(e=void 0===e||e<1?1:e)==0&&n.push(s)}}return n.sort((e,t)=>{e=e.get(v._Types._WeeklyPeriodicEvent.timeStart,l.ObjectType.String),t=t.get(v._Types._WeeklyPeriodicEvent.timeStart,l.ObjectType.String);return e===t?0:e<t?-1:1}),n}}});
//# sourceMappingURL=sourceMap.map